<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汎用コスト計算</title>
    <style>
        body {
            touch-action: manipulation; /* ← ダブルタップズームを無効化、ピンチは許可 */
            font-family: sans-serif;
            background: #f0f0f0;
            padding: 30px;
            text-align: center;
        }

        .calculator {
            width: 100%;
            max-width: 420px;
            margin: 0 auto;
        }

        .sectionA {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .input-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .input-group label {
            flex: 0 0 100px; /* ラベル幅を固定 */
            color: #1565c0;
            font-weight: bold;
            text-align: left;
        }


        .sectionA label {
            color: #1565c0;
            font-weight: bold;
            min-width: 100px;
        }

        .input-container input {
            width: 100%;
            border: 2px solid #90caf9;
            background-color: #ffffff;
            padding: 6px;
            border-radius: 4px;
            font-size: 17px;
            box-sizing: border-box;
            text-align: right;
        }

        #nameA,
        #priceA,
        #volumeA,
        #usageA {
            touch-action: manipulation;
        }        

        button {
            padding: 10px 20px;
            font-size: 16px;
            margin-top: 15px;
            cursor: pointer;
        }

        #result {
            margin-top: 20px;
            font-size: 18px;
            color: #333;
            text-align: left;
        }

        .resultA {
            color: #1565c0;
        }
        
        /* ログ領域 */
        #logContainer {
            max-width: 420px;
            margin: 20px auto 0;
            text-align: left;
        }
        #logContainer h3 {
            margin-bottom: 8px;
            font-size: 18px;
            color: #1565c0;
        }
        #calcLog {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #calcLog li {
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 8px;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .logText {
            flex: 1;
            margin-right: 8px;
            word-break: break-all;
        }
        .logBtn {
            font-size: 14px;
            font-weight: bold;
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            margin-left: 4px;
        }
        .logBtn.copy {
            background: #e3f2fd;
            color: #1565c0;
        }
        .logBtn.delete {
            background: #ffebee;
            color: #c62828;
        }
        
        .formula-note {
            font-style: italic;
            font-size: 14px;
            color: #777;
            margin-top: 4px;
            text-align: left;
        }

        /* 電卓ポップアップ */

        #floatingCalc {
            display: none;
            position: absolute;
            z-index: 1000;
            background: #fff;
            border-left: 18px solid #FFFFFF;
            border-right: 18px solid #FFFFFF;
            border-bottom: 64px solid #FFFFFF;
            border-top: 1px solid #FFFFFF;
            
            /* ↓↓↓ ここを拡大 ↓↓↓ */
            padding: 20px;       /* 内側の余白を増やす（広く見せる） */
            max-width: 360px;    /* 電卓全体の横幅を広げる */
            max-height: 500px;  /* 縦方向の上限を指定 */            
            border-radius: 10px;
            font-weight: 600;
        }



        #calcDisplay {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 0px;
            text-align: right;
            min-width: 120px;
        }

        #calcButtons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            column-gap: 10px; /* ← 横の隙間を広げる */
            row-gap: 6px;     /* ← 縦の隙間は現状維持 */
        }

        #calcButtons button {
            height: 40px;
            font-size: 20px;
            font-weight: bold;
            background-color: #e3f2fd;
            border: none;
            border-radius: 4px;
            color: #1565c0;
            cursor: pointer;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #calcApply {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
            margin-top: 8px;
            width: 100%;
        }

        #calcApply button {
            height: 40px;
            font-size: 20px;
            background-color: #e3f2fd;
            border: none;
            border-radius: 4px;
            color: #1565c0;
            cursor: pointer;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #calcApply > button#equals {
            grid-column: 1;
        }

        #calcApply > .spacer {
            grid-column: 2;
        }

        #calcApply > button#apply {
            grid-column: 3 / span 2;
            background-color: #ff9800;
            color: #fff;
        }
        
        #calculate-btn {
            font-size: 20px;
            padding: 12px 30px;
            background-color: #ff5722;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #calculate-btn:hover {
            background-color: #f4511e;
        }
        
        /* プレースホルダー内のボタンを完全に非表示にする */
        #calcLog li.placeholder-log .logBtn {
            display: none;
        }

        /* ログヘッダーのレイアウト */
        #logHeader {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        /* トースト通知 */
        #toast {
            visibility: hidden;
            min-width: 160px;
            background-color: #323232;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 10px;
            position: fixed;
            z-index: 2000;
            left: 50%;
            bottom: 40px;
            transform: translateX(-50%);
            font-size: 16px;
            opacity: 0;
            transition: opacity 0.4s, bottom 0.4s;
        }
        #toast.show {
            visibility: visible;
            opacity: 0.95;
            bottom: 60px;
        }
        
        .input-container {
            flex: 1;
        }

        #floatingCalc {
            position: absolute;
            transform-origin: top center;
        }
                
    </style>
</head>
<body>
    <div class="calculator">
        <h2>汎用コスト計算</h2>
        <div class="sectionA">
            <div class="input-group">
                <label for="nameA">商品名</label>
                <div class="input-container">
                    <input type="text" id="nameA" placeholder="任意" />
                </div>
            </div>
            
            <div class="input-group">
                <label for="priceA">価　格</label>
                <div class="input-container">
                    <input type="number" id="priceA" />
                </div>
            </div>
            
            <div class="input-group">
                <label for="volumeA">本体量</label>
                <div class="input-container">
                    <input type="number" id="volumeA" />
                </div>
            </div>
            
            <div class="input-group">
                <label for="usageA">使用量</label>
                <div class="input-container">
                    <input type="number" id="usageA" value="1" />
                </div>
            </div>
        </div>


        <button id="calculate-btn">計算する</button>
        <div id="result"></div>
    </div>

    <div id="floatingCalc">
        <div id="calcDisplay">0</div>
        <div id="calcButtons">
            <button>７</button>
            <button>８</button>
            <button>９</button>
            <button>÷</button>
            <button>４</button>
            <button>５</button>
            <button>６</button>
            <button>×</button>
            <button>１</button>
            <button>２</button>
            <button>３</button>
            <button>－</button>
            <button>０</button>
            <button>.</button>
            <button>C</button>
            <button>＋</button>
        </div>
        <div id="calcApply">
            <button id="equals">=</button>
            <div class="spacer"></div>
            <button id="apply">入力</button>
        </div>
    </div>

    <div id="logContainer" style="display:none;">
        <div id="logHeader">
            <h3>計算ログ</h3>
            <div id="logActions">
                <button id="copyAllLogs" class="logBtn copy">全コピー</button>
                <button id="clearAllLogs" class="logBtn delete" type="button">全クリア</button>
            </div>
        </div>
        <ul id="calcLog"></ul>
    </div>

    <div id="customConfirmModal" style="display:none; position:fixed; z-index:3000; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.4);">
        <div style="background-color:#fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 300px; border-radius: 8px;">
            <p style="font-size: 16px; font-weight: bold;">計算ログをすべてクリアしますか？</p>
            <div style="display: flex; justify-content: space-around; margin-top: 20px;">
                <button id="confirmYes" class="logBtn delete" style="padding: 8px 16px;">はい</button>
                <button id="confirmNo" class="logBtn copy" style="padding: 8px 16px;">いいえ</button>
            </div>
        </div>
    </div>


    <!-- トースト -->
    <div id="toast" aria-live="polite" role="status">コピーしました</div>

    <script>
        /* -----------------------------
           トースト（軽い通知）
           ----------------------------- */
        function showToast(message) {
            const toast = document.getElementById("toast");
            toast.textContent = message;
            toast.classList.add("show");
            clearTimeout(toast._hideTimer);
            toast._hideTimer = setTimeout(() => {
                toast.classList.remove("show");
            }, 2000);
        }

        /* -----------------------------
           コピー（トースト付き・簡潔）
           ----------------------------- */

        function copyTextToClipboard(text) {
            // 空文字チェック（コピー不要なときは早期終了）
            if (!text || String(text).trim() === "") {
                showToast('ログがありません');
                return;
            }

            // 優先：モダンAPI（Promiseを返す）
            if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {
                navigator.clipboard.writeText(String(text))
                    .then(() => {
                        showToast('コピーしました'); // 成功したらトースト
                    })
                    .catch((err) => {
                        // モダンAPIが拒否された／失敗した場合、フォールバックを試す
                        console.error('clipboard.writeText failed:', err);
                        const ok = fallbackCopyByExec(String(text));
                        showToast(ok ? 'コピーしました' : 'コピーに失敗しました');
                    });
                return;
            }

            // モダンAPIが無い：強制的にフォールバック
            const ok = fallbackCopyByExec(String(text));
            showToast(ok ? 'コピーしました' : 'コピーに失敗しました');
        }

        /**
         * フォールバック：隠しtextarea＋document.execCommand('copy')
         * 戻り値：true=成功, false=失敗
         */
        function fallbackCopyByExec(text) {
            try {
                const ta = document.createElement('textarea');
                ta.value = text;
                // 画面に影響を与えないよう最小化して固定配置
                ta.setAttribute('readonly', '');
                ta.style.position = 'fixed';
                ta.style.left = '-9999px';
                ta.style.top = '0';
                ta.style.opacity = '0';
                document.body.appendChild(ta);

                // 選択（mobileでの選択対策）
                ta.focus();
                ta.select();

                // execCommandは boolean を返す実装が多い
                const successful = document.execCommand('copy');

                document.body.removeChild(ta);
                return !!successful;
            } catch (err) {
                console.error('fallbackCopyByExec error:', err);
                return false;
            }
        }



        /* -----------------------------
           電卓・ログ・計算の全ロジック
           イベントはDOMContentLoadedで登録
           ----------------------------- */
        let calcExpression = '';
        let calcEvaluated = false;
        let calcResult = null;
        let activeInput = null;



        // ページ読み込み完了後にイベント登録
        document.addEventListener("DOMContentLoaded", () => {

            // --- 全クリア ---
            const clearBtn = document.getElementById('clearAllLogs');
            const customModal = document.getElementById('customConfirmModal');
            const confirmYes = document.getElementById('confirmYes');
            const confirmNo = document.getElementById('confirmNo');

            // ★ 修正後の記述 ★：ダブルタップ拡大を確実に防ぐ
            clearBtn.addEventListener('pointerdown', (e) => {
                e.preventDefault(); 
                e.stopPropagation();
                clearBtn.classList.add('active');
            }, { passive: false }); // <-- 拡大防止を確実にするための重要な追加

            clearBtn.addEventListener('pointerup', (e) => {
                clearBtn.classList.remove('active');
            });

            clearBtn.addEventListener('click', (e) => {
                e.stopPropagation();

                const logList = document.getElementById('calcLog');
                const logs = logList.querySelectorAll('li:not(.placeholder-log)').length;
                
                if (logs === 0) {
                    showToast('削除するログがありません');
                    return;
                }
                
                // カスタムモーダルを表示
                customModal.style.display = 'block';
            });

            // --- カスタムモーダル処理 ---
            confirmYes.addEventListener('click', (e) => {
                customModal.style.display = 'none';
                const logList = document.getElementById('calcLog');
                logList.innerHTML = '';
                showToast('ログをクリアしました');
                e.stopPropagation();
            });

            confirmNo.addEventListener('click', (e) => {
                customModal.style.display = 'none';
                e.stopPropagation();
            });

            clearBtn.addEventListener('touchcancel', () => {
                clearBtn.classList.remove('active');
            });


                // touchcancel/pointercancel の対応
                clearBtn.addEventListener('touchcancel', () => {
                    clearBtn.classList.remove('active');
                });

            // --- 全コピー ---
            // ★ 修正後の記述 ★：ダブルタップ拡大を確実に防ぐ
            document.getElementById('copyAllLogs').addEventListener('pointerdown', (e) => {
                e.preventDefault(); // これで拡大を防止
                e.stopPropagation();
            }, { passive: false }); // <-- passive: false を追加

            document.getElementById('copyAllLogs').addEventListener('pointerup', (e) => {
                e.preventDefault();
                const logs = Array.from(
                    document.querySelectorAll('#calcLog li:not(.placeholder-log) .logText')
                ).map(el => el.textContent.trim()).filter(t => t !== "");
                if (logs.length === 0) {
                    showToast('ログがありません');
                    return;
                }
                const allText = logs.join('\n');
                copyTextToClipboard(allText);
            });
            // --- 終了 --- 修正対象の全コピーボタン処理のブロック (置き換え用)

            // --- 計算ボタン ---
            document.getElementById('calculate-btn').addEventListener('click', (e) => {
                e.preventDefault();
                calculate();
            });

            // --- 電卓トグル：number入力欄で電卓を表示（pointer/touch 対応） ---
            document.querySelectorAll("input[type=number]").forEach(input => {
                const activateCalc = (evt) => {
                    evt.preventDefault();
                    evt.stopPropagation();
                    // showCalculator expects the input element
                    showCalculator(evt.target || input);
                };
                input.addEventListener('touchstart', activateCalc, { passive: false });
                input.addEventListener('mousedown', activateCalc);

                // ブラウザのフォーカスでキーボードが出るのを防ぐ
                input.addEventListener('focus', (e) => e.target.blur());
            });

            // --- 電卓ボタン群のイベント ---
            const calcButtons = Array.from(document.querySelectorAll('#calcButtons button'));
            calcButtons.forEach(button => {
                button.addEventListener('pointerdown', (e) => {
                    e.preventDefault();
                    const value = button.textContent.trim();
                    if (value === 'C') {
                        clearCalc();
                        return;
                    }
                    if (value === '＋') {
                        press('+');
                        return;
                    }
                    // 通常の文字
                    press(value);
                });
            });

            // equals / apply
            document.getElementById('equals').addEventListener('pointerdown', (e) => {
                e.preventDefault();
                calculateExpression();
            });

            document.getElementById('apply').addEventListener('pointerup', (e) => {
                e.preventDefault();
                applyToInput();
            });

            // --- 商品名(nameA)入力時に Enter で次の入力欄に移動する処理 ---
                document.getElementById('nameA').addEventListener('keydown', (e) => {
                    // Enter キーが押されたかをチェック
                    if (e.key === "Enter" || e.keyCode === 13) {
                        e.preventDefault(); // フォームの誤送信を防ぐ
                        
                        // 次の入力欄（価格 priceA）を取得
                        const nextInput = document.getElementById('priceA');
                        
                        if (nextInput) {
                            nextInput.focus();
                            
                            // 次の要素（価格）が数値入力であり、電卓が使用される場合は、電卓を表示
                            if (nextInput.type === 'number' && typeof showCalculator === 'function') {
                                // focus() の後に電卓が表示されるように、念のためsetTimeoutで分離します
                                setTimeout(() => {
                                    showCalculator(nextInput);
                                }, 0);
                            }
                        }
                    }
                });
                // --- 商品名(nameA)入力時に Enter で次の入力欄に移動する処理 (終了) ---


        });

        /* -----------------------------
           電卓表示・位置調整
           ----------------------------- */
        function showCalculator(input) {
            if (!input) return;
            activeInput = input;
            const calc = document.getElementById("floatingCalc");
            calcExpression = '';
            calcEvaluated = false;
            calcResult = null;
            document.getElementById("calcDisplay").textContent = '0';
            calc.style.display = 'block';

            adjustCalculatorPosition();
            // スクロール調整（表示領域確保）
            const calcRect = calc.getBoundingClientRect();
            const newTop = window.scrollY + input.getBoundingClientRect().bottom + 5;
            if (newTop + calcRect.height > window.scrollY + window.innerHeight) {
                window.scrollBy({ top: (newTop + calcRect.height) - (window.scrollY + window.innerHeight) + 10, behavior: 'smooth' });
            }
        }

        function adjustCalculatorPosition() {

                window.addEventListener('resize', adjustCalculatorPosition);
                window.addEventListener('scroll', adjustCalculatorPosition);

                // 外部クリックで電卓を閉じる
                document.addEventListener('click', (e) => {
                    const calc = document.getElementById('floatingCalc');
                    if (!calc) return;
                    if (calc.style.display !== 'block') return;
                    const tgt = e.target;
                    if (calc.contains(tgt)) return;
                    // 入力欄がクリックされたら閉じない
                    if (tgt.tagName === 'INPUT' && tgt.type === 'number') return;
                    calc.style.display = 'none';
                    activeInput = null;
                });
        }

        /* -----------------------------
           電卓内部ロジック
           ----------------------------- */
        function press(value) {
            if (calcEvaluated) {
                calcExpression = '';
                calcEvaluated = false;
            }
            calcExpression += value;
            document.getElementById("calcDisplay").textContent = calcExpression;
        }

        function clearCalc() {
            calcExpression = '';
            calcEvaluated = false;
            calcResult = null;
            document.getElementById("calcDisplay").textContent = '0';
            if (activeInput) {
                activeInput.value = '';
                removeFormulaBelow(activeInput);
            }
        }

        function calculateExpression() {
            try {
                // ★ 全角 → 半角変換（数字・記号すべて）
                const normalizedExpression = calcExpression.replace(/[！-～]/g, ch =>
                    String.fromCharCode(ch.charCodeAt(0) - 0xFEE0)
                )
                .replace(/×/g, '*')
                .replace(/÷/g, '/')
                .replace(/－/g, '-')
                .replace(/＋/g, '+')
                .replace(/，/g, ',')
                .replace(/．/g, '.');

                // 計算を実行（evalに渡すのは正規化済みの式）
                calcResult = eval(normalizedExpression);

                // ★ 表示は「元の式（全角含む）」＋「＝結果」
                document.getElementById("calcDisplay").textContent = `${calcExpression} = ${calcResult}`;

                // ★ calcExpressionは壊さず保持（次の入力ボタンで式が残る）
                calcEvaluated = true;

            } catch (err) {
                document.getElementById("calcDisplay").textContent = '式エラー';
                calcEvaluated = false;
            }
        }

        function applyToInput() {
            if (!activeInput) return;

            // 未入力（テンキー押してない）ならスキップして次へ
            if (!calcExpression || calcExpression.trim() === '') {
                // 現在の値を維持し、次の入力欄へ進む
                const currentInput = activeInput;
                document.getElementById("floatingCalc").style.display = "none";
                activeInput = null;

                // 次の入力欄に自動移動
                const allInputs = Array.from(document.querySelectorAll(".sectionA input"));
                const currentIndex = allInputs.indexOf(currentInput);
                if (currentIndex > -1 && currentIndex < allInputs.length - 1) {
                    const nextInput = allInputs[currentIndex + 1];
                    setTimeout(() => {
                        nextInput.focus();
                        if (nextInput.type === 'number') showCalculator(nextInput);
                    }, 0);
                }
                return; // ← スキップ確定
            }

            // 1. 計算を実行（未計算の場合）
            if (!calcEvaluated) calculateExpression();

            const currentInput = activeInput;

            if (calcEvaluated && !isNaN(calcResult)) {
                // 結果を入力欄に反映
                currentInput.value = calcResult;
                showFormulaBelow(currentInput, calcExpression, calcResult);
            } else {
                removeFormulaBelow(currentInput);
            }

            // 電卓を閉じる
            document.getElementById("floatingCalc").style.display = "none";
            activeInput = null;

            // 次の入力欄にフォーカスを移動
            const allInputs = Array.from(document.querySelectorAll(".sectionA input"));
            const currentIndex = allInputs.indexOf(currentInput);

            if (currentIndex > -1 && currentIndex < allInputs.length - 1) {
                const nextInput = allInputs[currentIndex + 1];
                setTimeout(() => {
                    nextInput.focus();
                    if (nextInput.type === 'number') showCalculator(nextInput);
                }, 0);
            }
        }



        document.addEventListener("keydown", (e) => {
            const calc = document.getElementById("floatingCalc");
            if (!activeInput || !calc || calc.style.display === "none") return;
            if (/^[0-9+\-*/\.]$/.test(e.key)) {
                press(e.key);
                e.preventDefault();
            } else if (e.key === "Enter") {
                applyToInput();
                e.preventDefault();
            } else if (e.key === "Escape" || e.key === "c" || e.key === "C") {
                clearCalc();
                e.preventDefault();
            }
        });

        function showFormulaBelow(input, expression, result) {
            let note = input.nextElementSibling;
            if (!note || !note.classList.contains("formula-note")) {
                note = document.createElement("div");
                note.className = "formula-note";
                input.parentNode.appendChild(note);
            }

            // 全角数字・演算子を半角に統一
            const normalizedExpr = expression.replace(/[！-～]/g, ch =>
                String.fromCharCode(ch.charCodeAt(0) - 0xFEE0)
            )
            .replace(/×/g, '*')
            .replace(/÷/g, '/')
            .replace(/－/g, '-')
            .replace(/＋/g, '+')
            .replace(/，/g, ',')
            .replace(/．/g, '.');

            // 四則演算子が含まれているか判定
            const hasOperator = /[+\-*/]/.test(normalizedExpr);

            if (hasOperator) {
                // 表示用に * → ×, / → ÷ に戻す
                const displayExpr = normalizedExpr.replace(/\*/g, '×').replace(/\//g, '÷');
                note.textContent = `${displayExpr} = ${result}`;
            } else {
                note.textContent = `${result}`;
            }
        }


        /* -----------------------------
           ログ管理
           ----------------------------- */

        function addLog(text) {
            const logList = document.getElementById('calcLog');
            const logContainer = document.getElementById('logContainer');

            // ログ欄を表示
            logContainer.style.display = 'block';

            const li = document.createElement('li');

            const span = document.createElement('span');
            span.className = 'logText';
            span.textContent = text;

            const copyBtn = document.createElement('button');
            copyBtn.className = 'logBtn copy';
            copyBtn.textContent = 'コピー';
            copyBtn.addEventListener('click', (e) => {
                e.preventDefault();
                copyTextToClipboard(span.textContent);
            });

            const delBtn = document.createElement('button');
            delBtn.className = 'logBtn delete';
            delBtn.textContent = '削除';
            delBtn.addEventListener('click', (e) => {
                e.preventDefault();
                li.remove();
                // ログが空になったら非表示にする
                if (logList.querySelectorAll('li').length === 0) {
                    logContainer.style.display = 'none';
                }
            });

            li.appendChild(span);
            li.appendChild(copyBtn);
            li.appendChild(delBtn);

            // 先頭に追加（最新が上）
            logList.insertBefore(li, logList.firstChild);


        }




        /* -----------------------------
           計算処理（既存ロジック）
           ----------------------------- */
        function calculate() {
            const nameA = document.getElementById('nameA').value.trim() || '商品A';
            const vA = parseFloat(document.getElementById('volumeA').value);
            const uA = parseFloat(document.getElementById('usageA').value);
            const pA = parseFloat(document.getElementById('priceA').value);
            let output = '';
            let logText = '';

            if (vA > 0 && uA > 0 && pA >= 0 && !isNaN(vA) && !isNaN(uA) && !isNaN(pA)) {
                const costA = pA * (uA / vA);
                output = `<div class="resultA"><strong>${nameA}</strong><br>` +
                         `1回のコスト：${costA.toFixed(2)} 円</div>`;
                
                logText = `${nameA}: ${pA} 円 ÷ ${vA} × ${uA} = ${costA.toFixed(2)} 円`;
            } else {
                output = `<div class="resultA">商品Aの入力が不完全です</div>`;
                logText = '商品Aの入力が不完全です';
            }

            document.getElementById('result').innerHTML = output;
            addLog(logText);
        }
        // iOS Safari対策：ダブルタップズームを完全に防ぐ
        document.addEventListener('dblclick', e => e.preventDefault());   
        
    </script>
    <!-- ダミーの空白領域 -->
    <div style="height: 1000px;"></div>
</body>
</html>
